#define LZMA_IMPLEMENTATION
#include "lzma.h"

#include <stdio.h>
#include <stdint.h>
#include <assert.h>
#include <string.h>

int main()
{
    // uint8_t data[] = "I'd just like to interject for a moment. "
    //                  "What you're referring to as C++, is in fact, C/C++, "
    //                  "or as I've recently taken to calling it, C plus C++. "
    //                  "C++ is not an programming language unto itself, "
    //                  "but rather another free component of a fully functioning C system made useful by the libc, "
    //                  "preprocessor and vital system components comprising "
    //                  "a full programming language as defined by POSIX.\n\n"
    //                  "- Tinus Lorvalds";
    char data[] = "9.929577708244323730e-01,5.422534942626953125e-01,5.422534942626953125e-01,5.528169274330139160e-01,5.492957830429077148e-01,5.246478915214538574e-01,5.281690359115600586e-01,4.612676203250885010e-01,3.204225301742553711e-01,2.077464759349822998e-01,4.577464610338211060e-02,1.091549322009086609e-01,1.408450752496719360e-01,1.408450752496719360e-01,1.549295783042907715e-01,2.183098644018173218e-01,1.795774698257446289e-01,1.619718372821807861e-01,1.584507077932357788e-01,1.690140813589096069e-01,1.514084488153457642e-01,1.584507077932357788e-01,1.549295783042907715e-01,1.584507077932357788e-01,1.549295783042907715e-01,1.443661898374557495e-01,1.373239457607269287e-01,1.549295783042907715e-01,1.408450752496719360e-01,1.514084488153457642e-01,1.443661898374557495e-01,1.549295783042907715e-01,1.584507077932357788e-01,1.901408433914184570e-01,1.866197139024734497e-01,2.218309789896011353e-01,2.323943674564361572e-01,2.605633735656738281e-01,2.781690061092376709e-01,3.133802711963653564e-01,3.239436745643615723e-01,3.309859037399291992e-01,3.309859037399291992e-01,3.415493071079254150e-01,3.204225301742553711e-01,3.239436745643615723e-01,2.922535240650177002e-01,3.133802711963653564e-01,2.887323796749114990e-01,2.781690061092376709e-01,2.570422589778900146e-01,2.711267471313476562e-01,2.711267471313476562e-01,2.852112650871276855e-01,2.781690061092376709e-01,2.781690061092376709e-01,2.605633735656738281e-01,2.852112650871276855e-01,2.781690061092376709e-01,2.746478915214538574e-01,2.605633735656738281e-01,2.711267471313476562e-01,2.359154969453811646e-01,2.605633735656738281e-01,2.500000000000000000e-01,2.570422589778900146e-01,2.394366264343261719e-01,2.500000000000000000e-01,2.288732379674911499e-01,2.359154969453811646e-01,2.253521084785461426e-01,2.394366264343261719e-01,2.077464759349822998e-01,2.323943674564361572e-01,2.359154969453811646e-01,2.288732379674911499e-01,2.183098644018173218e-01,2.288732379674911499e-01,2.112676054239273071e-01,2.253521084785461426e-01,2.183098644018173218e-01,2.147887349128723145e-01,2.147887349128723145e-01,2.218309789896011353e-01,2.112676054239273071e-01,2.218309789896011353e-01,2.077464759349822998e-01,2.183098644018173218e-01,2.323943674564361572e-01,2.253521084785461426e-01,2.183098644018173218e-01,2.253521084785461426e-01,2.218309789896011353e-01,2.323943674564361572e-01,2.218309789896011353e-01,2.359154969453811646e-01,2.359154969453811646e-01,2.464788705110549927e-01,2.992957830429077148e-01,5.563380122184753418e-01,1.000000000000000000e+00,5.598591566085815430e-01,5.492957830429077148e-01,5.528169274330139160e-01,5.598591566085815430e-01,5.422534942626953125e-01,5.176056623458862305e-01,4.612676203250885010e-01,3.697183132171630859e-01,2.570422589778900146e-01,4.225352033972740173e-02,0.000000000000000000e+00,6.338027864694595337e-02,8.802817016839981079e-02,9.154929220676422119e-02,1.654929518699645996e-01,1.690140813589096069e-01,1.584507077932357788e-01,1.584507077932357788e-01,1.584507077932357788e-01,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,4.000000000000000000e+00";

    uint8_t comp[sizeof(data) + LZMA_HEADER_SIZE];
    size_t comp_sz = sizeof(comp);
    assert(lzma_compress(comp, &comp_sz, data, sizeof(data)) == SZ_OK);

    uint8_t uncomp[sizeof(data)];
    size_t uncomp_sz = sizeof(uncomp);
    assert(lzma_uncompress(uncomp, &uncomp_sz, comp, &comp_sz) == SZ_OK);

    assert(memcmp(data, uncomp, sizeof(data)) == 0);

    printf("%s\n", uncomp);

    // print the compression ratio
    printf("Compression ratio: %f\n", sizeof(data) / (float)comp_sz);
}